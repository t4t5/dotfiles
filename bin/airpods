#!/bin/bash

# AirPods MAC address
AIRPODS_MAC="9C:F3:AC:4F:02:AA"
AIRPODS_MAX_MAC="90:9C:4A:DD:05:DE"

# Default to regular AirPods
MAC="$AIRPODS_MAC"

case "$1" in
    connect)
        if [ "$2" = "max" ]; then
            MAC="$AIRPODS_MAX_MAC"
            echo "Connecting to AirPods Max..."
        else
            echo "Connecting to AirPods..."
        fi
        CONNECT_OUTPUT=$(bluetoothctl connect "$MAC" 2>&1)
        if [ $? -ne 0 ]; then
            echo "Failed to connect:"
            echo "$CONNECT_OUTPUT"
            exit 1
        fi
        sleep 2
        pactl set-default-sink "bluez_output.$MAC" &>/dev/null
        echo "Connected successfully!"
        ;;
    disconnect)
        if [ "$2" = "max" ]; then
            MAC="$AIRPODS_MAX_MAC"
            echo "Disconnecting AirPods Max..."
        else
            echo "Disconnecting AirPods..."
        fi
        if bluetoothctl disconnect "$MAC" &>/dev/null; then
            echo "Disconnected successfully!"
        else
            echo "Failed to disconnect."
            exit 1
        fi
        ;;
    *)
        echo "Usage: airpods {connect|disconnect} [max]"
        echo "Examples:"
        echo "  airpods connect      - Connect to AirPods"
        echo "  airpods connect max  - Connect to AirPods Max"
        echo "  airpods disconnect   - Disconnect AirPods"
        exit 1
        ;;
esac
