#!/bin/bash

# Pre-generates all react-icon PNG previews.
# Run once to eliminate loading time when searching.

DIR="$(cd "$(dirname "$0")" && pwd)"
CACHE_DIR="${XDG_CACHE_HOME:-$HOME/.cache}/react-icons"
PKG_DIR="$CACHE_DIR/pkg"
PREVIEW_DIR="$CACHE_DIR/previews"

# Install react-icons npm package if not present
if [[ ! -d "$PKG_DIR/node_modules/react-icons" ]]; then
  mkdir -p "$PKG_DIR"
  (cd "$PKG_DIR" && npm install react-icons --silent 2>/dev/null)
fi

echo "Building all icon previews into $PREVIEW_DIR..."
node "$DIR/build-all-previews.mjs" "$PKG_DIR" "$PREVIEW_DIR"
echo "Done!"
